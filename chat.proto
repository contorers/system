syntax = "proto3";
package com.weiyu.chat;

option java_package = "com.ctr.cloud.proto";
option java_multiple_files = true;

message ChatMessage {
  // --- 基础信息 ---
  int64 id = 1;

  // 角色：ADMIN, USER, SYSTEM
  int32 roleType = 2;

  // 业务字段：存储时必须区分是 房间 还是 个人
  int64 roomId = 3;
  int64 senderId = 4;
  int64 receiverId = 5;
  int64 createTime = 6;

  enum MsgType {
    TEXT = 0;
    IMAGE = 1;
    AUDIO = 2;
    VIDEO = 3;
    FILE = 4;
    SYSTEM = 9;
  }

  // --- 内容 ---
  MsgType type = 7;
  string content = 8;
  map<string, string> properties = 9;

  // --- 业务指令 ---
  // 例如：FRIEND_REQUEST, GROUP_CHAT, WITHDRAW(撤回)
  int32 pushType = 10;
}

message NetPacket {
  enum PacketType {
    UNKNOWN = 0;

    // 2. 业务位：从 1 开始
    CHAT = 1;
    HEARTBEAT = 2;
    LOGIN = 3;
    ACK = 4;

    // 3. 未来扩展：给你的 AI 服务预留
    AI_CHAT = 5;
  }
  PacketType type = 1;

  // --- 路由层 (信封信息) ---
  // 决定了 Consumer 怎么投递这个包
  int64 targetId = 2;

  // --- 载荷 ---
  // 里面是 ChatMessage 的二进制，或者 心跳包体，或者 ACK 包体
  bytes data = 3;
}
