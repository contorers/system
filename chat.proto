syntax = "proto3"; // 使用版本 3

// 1.这是给 Protobuf 编译器看的（逻辑分类）
// 在前端生成 JS 时，消息会叫 com.weiyu.chat.ChatMessage
package com.weiyu.chat; 

// =======================================================
// 2.【关键】这是给 Java 生成器看的（物理路径）
// 哪怕上面写的是 com.weiyu.chat，生成的 Java 文件依然会乖乖
// 跑到 com.example.project.entity.proto 包下面去！
// =======================================================
option java_package = "com.cloud.ctr.entity.proto";

// 3.开启多文件（之前讲过的）
option java_multiple_files = true;

// 1. 定义消息结构
message ChatMessage {
  string id = 1;           // 这里的 1, 2, 3 是字段的唯一编号，不是值！
  string roomId = 2;
  string senderId = 3;
  string content = 4;
  int64 createTime = 5;    // int64 对应 Java Long
  
  // 枚举类型
  enum MsgType {
    TEXT = 0;
    IMAGE = 1;
  }
  MsgType type = 6;
}

// 外层信封
message NetPacket {
  enum PacketType {
    CHAT = 0;
    HEARTBEAT = 1;
    LOGIN = 2;
  }
  PacketType type = 1; // 先读这个，知道是什么类型
  bytes data = 2;      // 这里面存真正的 ChatMessage 的二进制数据
}
